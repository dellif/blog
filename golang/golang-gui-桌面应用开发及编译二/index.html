<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>golang GUI 桌面应用开发及编译(二) - 不想敲代码的程序猿</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="DongGe" /><meta name="description" content="环境 基于 上一篇 基础 代码事例 安装 1 go get github.com/lxn/walk 代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 package main import ( &amp;#34;github.com/lxn/walk&amp;#34; . &amp;#34;github.com/lxn/walk/declarative&amp;#34; &amp;#34;strings&amp;#34; ) func main() { var inTE, outTE *walk.TextEdit MainWindow{ Title:" /><meta name="keywords" content="DongGe, php, golang" />






<meta name="generator" content="Hugo 0.83.1 with theme even" />


<link rel="canonical" href="https://blog.donglf681.com/golang/golang-gui-%E6%A1%8C%E9%9D%A2%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E5%8F%8A%E7%BC%96%E8%AF%91%E4%BA%8C/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.b5a744db6de49a86cadafb3b70f555ab443f83c307a483402259e94726b045ff.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css" integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin="anonymous">


<meta property="og:title" content="golang GUI 桌面应用开发及编译(二)" />
<meta property="og:description" content="环境 基于 上一篇 基础 代码事例 安装 1 go get github.com/lxn/walk 代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 package main import ( &#34;github.com/lxn/walk&#34; . &#34;github.com/lxn/walk/declarative&#34; &#34;strings&#34; ) func main() { var inTE, outTE *walk.TextEdit MainWindow{ Title:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://blog.donglf681.com/golang/golang-gui-%E6%A1%8C%E9%9D%A2%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E5%8F%8A%E7%BC%96%E8%AF%91%E4%BA%8C/" /><meta property="article:section" content="golang" />
<meta property="article:published_time" content="2021-05-10T10:11:35&#43;08:00" />
<meta property="article:modified_time" content="2021-05-10T10:11:35&#43;08:00" />

<meta itemprop="name" content="golang GUI 桌面应用开发及编译(二)">
<meta itemprop="description" content="环境 基于 上一篇 基础 代码事例 安装 1 go get github.com/lxn/walk 代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 package main import ( &#34;github.com/lxn/walk&#34; . &#34;github.com/lxn/walk/declarative&#34; &#34;strings&#34; ) func main() { var inTE, outTE *walk.TextEdit MainWindow{ Title:"><meta itemprop="datePublished" content="2021-05-10T10:11:35&#43;08:00" />
<meta itemprop="dateModified" content="2021-05-10T10:11:35&#43;08:00" />
<meta itemprop="wordCount" content="1054">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="golang GUI 桌面应用开发及编译(二)"/>
<meta name="twitter:description" content="环境 基于 上一篇 基础 代码事例 安装 1 go get github.com/lxn/walk 代码 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 package main import ( &#34;github.com/lxn/walk&#34; . &#34;github.com/lxn/walk/declarative&#34; &#34;strings&#34; ) func main() { var inTE, outTE *walk.TextEdit MainWindow{ Title:"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">DongGe</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/golang/">
        <li class="mobile-menu-item">Go语言</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/git/">
        <li class="mobile-menu-item">Git</li>
      </a>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">DongGe</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/golang/">Go语言</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/git/">Git</a>
      </li>
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
  <div class="post-content">
    <h1 id="环境">环境</h1>
<ul>
<li>基于 <a href="/golang/golang-gui-%E6%A1%8C%E9%9D%A2%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E5%8F%8A%E7%BC%96%E8%AF%91%E4%B8%80/">上一篇</a> 基础</li>
</ul>
<h1 id="代码事例">代码事例</h1>
<h2 id="安装">安装</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">go get github.com/lxn/walk
</code></pre></td></tr></table>
</div>
</div><h2 id="代码">代码</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">package</span> <span class="nx">main</span>
 
<span class="kn">import</span> <span class="p">(</span>
    <span class="s">&#34;github.com/lxn/walk&#34;</span>
    <span class="p">.</span> <span class="s">&#34;github.com/lxn/walk/declarative&#34;</span>
    <span class="s">&#34;strings&#34;</span>
<span class="p">)</span>
 
<span class="kd">func</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">inTE</span><span class="p">,</span> <span class="nx">outTE</span> <span class="o">*</span><span class="nx">walk</span><span class="p">.</span><span class="nx">TextEdit</span>
 
    <span class="nx">MainWindow</span><span class="p">{</span>
        <span class="nx">Title</span><span class="p">:</span>   <span class="s">&#34;SCREAMO&#34;</span><span class="p">,</span>
        <span class="nx">MinSize</span><span class="p">:</span> <span class="nx">Size</span><span class="p">{</span><span class="mi">600</span><span class="p">,</span> <span class="mi">400</span><span class="p">},</span>
        <span class="nx">Layout</span><span class="p">:</span>  <span class="nx">VBox</span><span class="p">{},</span>
        <span class="nx">Children</span><span class="p">:</span> <span class="p">[]</span><span class="nx">Widget</span><span class="p">{</span>
            <span class="nx">HSplitter</span><span class="p">{</span>
                <span class="nx">Children</span><span class="p">:</span> <span class="p">[]</span><span class="nx">Widget</span><span class="p">{</span>
                    <span class="nx">TextEdit</span><span class="p">{</span><span class="nx">AssignTo</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">inTE</span><span class="p">},</span>
                    <span class="nx">TextEdit</span><span class="p">{</span><span class="nx">AssignTo</span><span class="p">:</span> <span class="o">&amp;</span><span class="nx">outTE</span><span class="p">,</span> <span class="nx">ReadOnly</span><span class="p">:</span> <span class="kc">true</span><span class="p">},</span>
                <span class="p">},</span>
            <span class="p">},</span>
            <span class="nx">PushButton</span><span class="p">{</span>
                <span class="nx">Text</span><span class="p">:</span> <span class="s">&#34;SCREAM&#34;</span><span class="p">,</span>
                <span class="nx">OnClicked</span><span class="p">:</span> <span class="kd">func</span><span class="p">()</span> <span class="p">{</span>
                    <span class="nx">outTE</span><span class="p">.</span><span class="nf">SetText</span><span class="p">(</span><span class="nx">strings</span><span class="p">.</span><span class="nf">ToUpper</span><span class="p">(</span><span class="nx">inTE</span><span class="p">.</span><span class="nf">Text</span><span class="p">()))</span>
                <span class="p">},</span>
            <span class="p">},</span>
        <span class="p">},</span>
    <span class="p">}.</span><span class="nf">Run</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="安装依赖">安装依赖</h2>
<ul>
<li>rsrc 工具</li>
</ul>
<blockquote>
<p>码写好后，我们直接 go build 打包是不行的，golang 的图形 exe 需要依赖于 manifest 才能正常运行。而 go 却没有提供资源打包的所有功能，所以要把 manifest 嵌入 exe 文件中，还需要一个工具：rsrc。</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">go get github.com/akavel/rsrc
</code></pre></td></tr></table>
</div>
</div><p>==使用 rsrc 需要带上路径，我本机路径是<code>$GOPATH/bin/rsrc</code>==</p>
<h2 id="创建一个-manifest-文件-mainmanifest">创建一个 manifest 文件, main.manifest</h2>
<blockquote>
<p>什么是 manifest</p>
</blockquote>
<ul>
<li><a href="https://docs.microsoft.com/zh-cn/windows/win32/sbscs/manifests?redirectedfrom=MSDN">https://docs.microsoft.com/zh-cn/windows/win32/sbscs/manifests?redirectedfrom=MSDN</a></li>
</ul>
<blockquote>
<p>介绍：Manifests are XML files that accompany and describe side-by-side assemblies or isolated applications. Manifests uniquely identify the assembly through the assembly’s assemblyIdentity element. They contain information used for binding and activation, such as COM classes, interfaces, and type libraries, that has traditionally been stored in the registry. Manifests also specify the files that make up the assembly and may include Windows classes if the assembly author wants them to be versioned. Side-by-side assemblies are not registered on the system, but are available to applications and other assemblies on the system that specify dependencies in manifest files.</p>
</blockquote>
<p>是一种xml文件，标明所依赖的side-by-side组建。</p>
<p>如果用VS开发，可以Set通过porperty-&gt;configuration properties-&gt;linker-&gt;manifest file-&gt;Generate manifest To Yes来自动创建manifest来指定系统的和CRT的assembly版本。</p>
<p>详解
观察上面的manifest文件：</p>
<p><xml>这是xml声明：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">版本号----&lt;?xml version=&#34;1.0&#34;?&gt;。
这是必选项。 尽管以后的 XML 版本可能会更改该数字，但是 1.0 是当前的版本。

编码声明------&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;
这是可选项。 如果使用编码声明，必须紧接在 XML 声明的版本信息之后，并且必须包含代表现有字符编码的值。

standalone表示该xml是不是独立的，如果是yes，则表示这个XML文档时独立的，不能引用外部的DTD规范文件；如果是no，则该XML文档不是独立的，表示可以用外部的DTD规范文档。
</code></pre></td></tr></table>
</div>
</div><p><dependency>这一部分指明了其依赖于一个库：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&lt;assemblyIdentity&gt;属性里面还分别是：
type----系统类型，
version----版本号，
processorArchitecture----平台环境，
publicKeyToken----公匙
</code></pre></td></tr></table>
</div>
</div><blockquote>
<p>我们的示例</p>
</blockquote>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; standalone=&#34;yes&#34;?&gt;
&lt;assembly xmlns=&#34;urn:schemas-microsoft-com:asm.v1&#34; manifestVersion=&#34;1.0&#34; xmlns:asmv3=&#34;urn:schemas-microsoft-com:asm.v3&#34;&gt;
    &lt;assemblyIdentity version=&#34;1.0.0.0&#34; processorArchitecture=&#34;*&#34; name=&#34;SomeFunkyNameHere&#34; type=&#34;win32&#34;/&gt;
    &lt;dependency&gt;
        &lt;dependentAssembly&gt;
            &lt;assemblyIdentity type=&#34;win32&#34; name=&#34;Microsoft.Windows.Common-Controls&#34; version=&#34;6.0.0.0&#34; processorArchitecture=&#34;*&#34; publicKeyToken=&#34;6595b64144ccf1df&#34; language=&#34;*&#34;/&gt;
        &lt;/dependentAssembly&gt;
    &lt;/dependency&gt;
    &lt;asmv3:application&gt;
        &lt;asmv3:windowsSettings xmlns=&#34;http://schemas.microsoft.com/SMI/2005/WindowsSettings&#34;&gt;
            &lt;dpiAware&gt;true&lt;/dpiAware&gt;
        &lt;/asmv3:windowsSettings&gt;
    &lt;/asmv3:application&gt;
&lt;/assembly&gt;
</code></pre></td></tr></table>
</div>
</div><h1 id="生成-rsrcsyso">生成 rsrc.syso</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">$GOPATH/bin/rsrc -manifest main.manifest -o rsrc.syso
</code></pre></td></tr></table>
</div>
</div><h1 id="打包成-exe-文件">打包成 exe 文件</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">dongge@dongge-PC:/data/webroot/localgo.test$ go build
main.go:6:2: build constraints exclude all Go files in /home/dongge/golang/pkg/mod/github.com/lxn/walk@v0.0.0-20191128110447-55ccb3a9f5c1
dongge@dongge-PC:/data/webroot/localgo.test$ CGO_EBABLED=1 go build
main.go:6:2: build constraints exclude all Go files in /home/dongge/golang/pkg/mod/github.com/lxn/walk@v0.0.0-20191128110447-55ccb3a9f5c1
dongge@dongge-PC:/data/webroot/localgo.test$ CGO_EBABLED=1 GOOS=windows go build
dongge@dongge-PC:/data/webroot/localgo.test$ CGO_EBABLED=1 GOOS=windows go build -ldflags=&#34;-H windowsgui&#34;

</code></pre></td></tr></table>
</div>
</div><p>==<code>go build</code> 虽然会生成 exe 文件，但会带着 cmd 命令窗口，通过加上参数 <code>go build -ldflags=&quot;-H windowsgui&quot;</code>去除命令窗口==</p>
<h1 id="打包图标">打包图标</h1>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">rsrc -manifest test.manifest –ico icon.ico -o rsrc.syso
</code></pre></td></tr></table>
</div>
</div>
  </div>
</article>
        </div>
        

  

  

      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
      <a href="mailto:donglf@88.com" class="iconfont icon-email" title="email"></a>
      <a href="https://github.com/donglf681" class="iconfont icon-github" title="github"></a>
  <a href="https://blog.donglf681.com/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    &copy; 
    2021<span class="heart"><i class="iconfont icon-heart"></i></span><span>DongGe <a href="http://beian.miit.gov.cn" target="_blank" rel="noopener">闽ICP备2021002489号-1</a></span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js" integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js" integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin="anonymous"></script>



<script type="text/javascript" src="/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js"></script>








</body>
</html>
